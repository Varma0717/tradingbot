<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-100">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ title }} - TradeMantra{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    {% block meta %}
    <meta name="description" content="TradeMantra - India's leading AI-powered trading platform for automated trading strategies and portfolio management">
    <meta name="keywords" content="automated trading, AI trading, Indian stock market, NSE, BSE, algorithmic trading">
    <meta property="og:title" content="TradeMantra - AI-Powered Trading Platform">
    <meta property="og:description" content="Professional trading platform with AI-driven strategies for Indian stock markets">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    {% endblock %}
    
    <!-- Stylesheets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom Styles -->
    <style>
        .sidebar-link {
            @apply flex items-center px-4 py-2 text-gray-700 rounded-md hover:bg-gray-200 transition-colors duration-200;
        }
        .sidebar-link.active {
            @apply bg-blue-600 text-white hover:bg-blue-700;
        }
        .brand-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="h-full">
    <div class="min-h-full">
        {% if current_user.is_authenticated %}
        <!-- Sidebar for authenticated users -->
        <div class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg z-30 transform md:translate-x-0 transition-transform duration-200 ease-in-out" id="sidebar">
            <div class="flex items-center justify-center h-16 border-b border-gray-200 brand-gradient">
                <h1 class="text-2xl font-bold text-white">TradeMantra</h1>
            </div>
            <nav class="mt-6 px-4">
                {% if current_user.is_admin %}
                    <div class="mb-4">
                        <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Admin Panel</h3>
                        <a href="{{ url_for('admin.dashboard') }}" class="sidebar-link {% if 'admin' in request.path and 'dashboard' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2zm0 0V9a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path>
                            </svg>
                            Dashboard
                        </a>
                        <a href="{{ url_for('admin.manage_users') }}" class="sidebar-link {% if 'admin' in request.path and 'users' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                            </svg>
                            Users
                        </a>
                        <a href="{{ url_for('admin.audit_trail') }}" class="sidebar-link {% if 'audit' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            Audit Trail
                        </a>
                        {% if config.DEBUG %}
                        <a href="{{ url_for('admin.view_logs') }}" class="sidebar-link {% if 'logs' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            System Logs
                        </a>
                        {% endif %}
                    </div>
                {% else %}
                    <div class="mb-4">
                        <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Trading</h3>
                        <a href="{{ url_for('user.dashboard') }}" class="sidebar-link {% if 'dashboard' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2zm0 0V9a2 2 0 012-2h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path>
                            </svg>
                            Dashboard
                        </a>
                        <a href="{{ url_for('user.orders') }}" class="sidebar-link {% if 'orders' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                            Orders
                        </a>
                        <a href="{{ url_for('user.strategies') }}" class="sidebar-link {% if 'strategies' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            Strategies
                        </a>
                        <a href="{{ url_for('user.billing') }}" class="sidebar-link {% if 'billing' in request.path %}active{% endif %}">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                            </svg>
                            Billing
                        </a>
                    </div>
                {% endif %}
                
                <!-- User Actions -->
                <div class="border-t border-gray-200 mt-6 pt-6">
                    <a href="{{ url_for('auth.logout') }}" class="sidebar-link text-red-600 hover:bg-red-50 hover:text-red-700">
                        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                        Logout
                    </a>
                </div>
            </nav>
        </div>
        <div class="md:pl-64 flex flex-col flex-1">
        {% else %}
        <!-- Navbar for unauthenticated users -->
        <nav class="bg-white shadow-sm border-b border-gray-200">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <a href="{{ url_for('index') }}" class="text-2xl font-bold brand-gradient bg-clip-text text-transparent">TradeMantra</a>
                        <div class="hidden md:block ml-10">
                            <div class="flex items-baseline space-x-4">
                                <a href="{{ url_for('pages.about') }}" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">About</a>
                                <a href="{{ url_for('pages.services') }}" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">Services</a>
                                <a href="{{ url_for('pages.contact') }}" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">Contact</a>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4">
                        <a href="{{ url_for('auth.login') }}" class="text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium transition-colors duration-200">Login</a>
                        <a href="{{ url_for('auth.register') }}" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200">Get Started</a>
                    </div>
                </div>
            </div>
        </nav>
        <div class="flex flex-col flex-1">
        {% endif %}
                    </div>
                    <div class="flex items-center">
                        <a href="{{ url_for('auth.login') }}" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Login</a>
                        <a href="{{ url_for('auth.register') }}" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Register</a>
                    </div>
                </div>
            </div>
        </nav>
        <div class="flex flex-col flex-1">
        {% endif %}
            <main class="flex-1">
                {% if not current_user.is_authenticated %}
                <!-- Remove padding for public pages to allow full-width sections -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8 py-4">
                        {% for category, message in messages %}
                        <div class="p-4 mb-4 text-sm rounded-lg {% if category == 'danger' %}bg-red-100 text-red-700{% elif category == 'success' %}bg-green-100 text-green-700{% else %}bg-blue-100 text-blue-700{% endif %}" role="alert">
                            {{ message }}
                        </div>
                        {% endfor %}
                    </div>
                    {% endif %}
                {% endwith %}
                {% block content %}{% endblock %}
                {% else %}
                <!-- Keep padding for authenticated user pages -->
                <div class="py-6">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8">
                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                <div class="p-4 mb-4 text-sm rounded-lg {% if category == 'danger' %}bg-red-100 text-red-700{% elif category == 'success' %}bg-green-100 text-green-700{% else %}bg-blue-100 text-blue-700{% endif %}" role="alert">
                                    {{ message }}
                                </div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
                        {% block content %}{% endblock %}
                    </div>
                </div>
                {% endif %}
            </main>
        </div>
    </div>

    <!-- Footer -->
    {% if not current_user.is_authenticated %}
    <footer class="bg-gray-900 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Company Info -->
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center mb-4">
                        <span class="text-2xl font-bold brand-gradient bg-clip-text text-transparent">TradeMantra</span>
                    </div>
                    <p class="text-gray-400 mb-4">
                        India's leading AI-powered trading platform offering automated strategies, 
                        real-time analytics, and professional trading tools for NSE and BSE markets.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <span class="sr-only">Twitter</span>
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                            </svg>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <span class="sr-only">LinkedIn</span>
                            <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Company</h3>
                    <ul class="space-y-2">
                        <li><a href="{{ url_for('pages.about') }}" class="text-gray-400 hover:text-white transition-colors">About Us</a></li>
                        <li><a href="{{ url_for('pages.services') }}" class="text-gray-400 hover:text-white transition-colors">Services</a></li>
                        <li><a href="{{ url_for('pages.contact') }}" class="text-gray-400 hover:text-white transition-colors">Contact</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Careers</a></li>
                    </ul>
                </div>

                <!-- Legal Links -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="{{ url_for('pages.privacy') }}" class="text-gray-400 hover:text-white transition-colors">Privacy Policy</a></li>
                        <li><a href="{{ url_for('pages.terms') }}" class="text-gray-400 hover:text-white transition-colors">Terms of Service</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Risk Disclosure</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition-colors">Compliance</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 mt-12 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="text-gray-400 text-sm">
                        <p>&copy; 2025 TradeMantra. All rights reserved.</p>
                        <p class="mt-1">SEBI Registered Investment Advisor | License No: INA000012345</p>
                    </div>
                    <div class="mt-4 md:mt-0 text-gray-400 text-sm">
                        <p>Made in India 🇮🇳</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    {% endif %}

</body>
</html>